{include file="common/heads" /}

<link rel="stylesheet" href="__STATIC__/hy/assets/style/emil.css">
    <link rel='stylesheet' href='__STATIC__/hy/assets/style/reset_android.css'>
    <script src="__STATIC__/hy/assets/js/reset.js"></script>
    <style type="text/css">
    	body{
    		background-color: #fff !important; 
    	}
    	 .ListBox {
		    display: flex;
		    justify-content: space-between;
		    flex-wrap: wrap;
		}
		 .ListBox .box {
		    margin-bottom: 0.49rem;
		    width: 100%;
		    height: 2rem;
		    box-shadow:0px 2px 5px 0px rgba(0, 0, 0, 0.1);
		    border-radius: 9px;
		    position: relative;
		}
		 .ListBox .box .listtop{
		    position: absolute;
		    top: -0.19rem;
		    left: -0.32rem;
		    width: 1.8rem;
		    height: 1.94rem;
		    border-radius: 0.18rem;
		}
		 .ListBox .box .listtop img{
		width: 100%;
		height: auto;
		margin: auto;
		border-radius: 11px;
		}
		 .ListBox .box .listbottom{
		    position: absolute;
		    top: 0px;
		    left: 1.6rem;
		    width: 4.28rem;
		    height: 100%;
		    padding: 0.2rem 0.2rem;
		    margin-top: 0.1rem;
		}
		 .ListBox .box .listbottom .title{
		    font-size:0.3rem;
		    color: #666666;
		    width: 3rem;
		    white-space: nowrap;
		    text-overflow:ellipsis;
		    overflow: hidden;
		    /*margin-top: 0.2rem;*/
		   padding: 0.1rem 0;
		}
		 .ListBox .box .listbottom .text p{
		    /*font-size: 0.24rem;
		    color: #7B7B7B;
		    white-space: nowrap;
		    text-overflow:ellipsis;
		    overflow: hidden;
		    margin-top: 0.2rem;
		    margin-bottom: 0.2rem;*/
		    display: inline;
		}
		 .ListBox .box .listbottom .star{
		    height: 0.25rem;
		    display: flex;
		    margin-top: 0.1rem;
		    margin-bottom: 0.1rem;
		    color: #666666;
		    font-size: 0.20rem;
		}
		 .ListBox .box .listbottom .star img{
		    width: 0.25rem;
		    height: 0.25rem;
		    margin-right: 0.1rem;
		}
		 .ListBox .box .listbottom .money{
		    font-size: 0.3rem;
		    color: #FB9220;
		    white-space: nowrap;
		    text-overflow:ellipsis;
		    overflow: hidden;
		}
		 .ListBox .box .listbottom .more{
		    display: inline-block;
		    font-size: 0.3rem;
		    color: #fff;
		    padding: 0.1rem 0.15rem;
		    background-color: #FF8522;
		    border-radius: 0.3rem;
		    position: absolute;
		    bottom: 0.2rem;
		}
		 .ListBox .box .Sold{
		    position: absolute;
		    right: 0.3rem;
		    top: 0.2rem;
		    color: #7B7B7B;
		    font-size: 0.2rem;
		}  
		.ListBox .text {
		    font-size: 0.24rem;
		    color: #7B7B7B;
		    white-space: nowrap;
		    text-overflow: ellipsis;
		    overflow: hidden;
		    /*margin-top: 0.2rem;*/
		    /*margin-top: 0.1rem;*/
		   	padding: 0.1rem 0;
		    }
		 .ListBox .box .go{
		    position: absolute;
		    right: -0.2rem;
		    top: 0.8rem;
		    width: 0.42rem;
		    height: 0.42rem;
		    background-color: #FB9220;
		    border-radius: 0.06rem;
		    display: flex;
		}   
		.ListBox .box .go i{
			color: #fff;
			margin: auto;
		}
		.ListBox {
		    background-color: #fff;
		    border-bottom:1px solid #e7e7e7;
		}
		 .ListBox .box{
		    box-shadow: none;
		    /* background-color: red; */
		    margin-top: 0.2rem;
		    margin-bottom: 0.2rem;
		}
		 .ListBox .box .listtop{
		    top: 0.3rem;
		    left: 0.3rem;
		    width: 1.4rem;
		    height: 1.4rem;
		    /*background-color: #FFBABA;*/
		    border-radius: 0.1rem;
		}
		.ListBox .box .listbottom{
		    margin-left: 0.52rem;
		}
		.colldel{
			width: 15%;
			height: 100%;
			display: none;
			height: 2rem;
			margin-bottom: 0.2rem;
			margin-top: 0.2rem;
		}
		.collfoot{
			width: 100%;
			height: 0.8rem;
			position: fixed;
			bottom: 0;
			display: none;
			border-top: 1px solid #F3F3F3;
		}
		.collfoot div{
			width: 50%;
			height: 100%;
			text-align: center;
			line-height: 0.8rem;
			color: #333333;
			font-size:0.36rem;
			background-color: #fff;
			z-index: 99;
		}
    </style>
    <div class="top" style="background-color: #fff;border-bottom: 1px solid #6666;">
        <div class="fl" onclick="window.location.href='/index.php/hy/content/personal'">
            <img src="__STATIC__/hy/assets/images/return.png" alt="">
        </div>
         <div style="float: right;padding: 0 0.1rem;color: #666666;" class="manage" onclick="collmanage()" >
            管理
        </div>
        <div style="float: right;padding: 0 0.1rem;color: #666666;display: none;" class="manageclose" onclick="collmanageclose()" >
            取消
        </div>
        <div class="title" style="color: #666666;">收藏</div>
    </div>
    <div class="collectlist">
    	<div class="ListBox" style="display: none;"> 
    		<div class="colldel">
    			<div style="margin: auto;"><input  type="checkbox"  /></div>
    		</div>
    		<div class="box" style="width: 84%;">
    			<div class="listtop">
    				<img src="http://sample.zaixian.jichuangsi.com/Uploads/Picture/2018-05-07/5aefc3db79dd3.jpg" onerror="errorImg(this)">
    			</div>
    			<div class="listbottom">
    				<div class="title">
    					让你的思维导图从零到颜值爆表！
    				</div> 
    			<div class="text"> 世界500强企业,上市公司,国内著名精品地产品牌,集民生地产/旅游综合体/体育及文化产业于一体的综合性企业,恒大集团</div>
    			<div class="star"><img src="/public/static/hy/assets/images/Stars.png" alt=""><img src="/public/static/hy/assets/images/Stars.png" alt=""><img src="/public/static/hy/assets/images/Stars.png" alt=""></div>
    			</div>
    		</div>
    	</div>
    </div>
    <div style="width: 100%;height: 1rem;text-align: center;line-height: 1rem;margin-bottom: 0.8rem;" onclick="getcollect()">加载更多...</div>
    <div class="collfoot">
    	<div style="border-right: 1px solid #F3F3F3;" onclick="collcheckbox()">全选</div>
    	<div class="delbtn" style="color: #999999;" onclick="delcollect()">删除</div>
    </div>
    <script>
    	function getcommgradexin(infoid){
    		if(infoid==null||infoid==""||infoid==undefined){
    			return 0;
    		}
    		var xinnum=0;
    		$.ajax({
				type:"get",
				url:"/index.php/hy/content/getcommgradexins/infoid/"+infoid,
				async:true,
				success:function(data){
					console.log(parseInt(data));
					xinnum=parseInt(data);
					var xinthtml = '';
					for(var j=1;j<=5;j++){
						if(j>xinnum){
							xinthtml+='<img style="width:0.19rem;height:0.18rem" src="/public/static/hy/assets/images/huix.png" alt="">';
						}else{
							xinthtml+='<img style="width:0.19rem;height:0.18rem" src="/public/static/hy/assets/images/Stars.png" alt="">';
						}
					}
					$(".star_"+infoid).append(xinthtml);
				}
			});
			return xinnum;
    	}
    	function collectgo(obj){
    		var infoid=$(obj).attr("data-data");
    		if(infoid!=null&&infoid!=""&&infoid!=undefined){
    			window.location.href="/index.php/hy/content/show/id/"+infoid;
    		}
    	}
    	function collmanage(){
    		$('.colldel').css("display","flex");
    		$('.collfoot').css("display","flex");
    		$('.manageclose').css("display","block");
    		$('.manage').css("display","none");
    	}
    	function collmanageclose(){
    		$('.colldel').css("display","none");
    		$('.collfoot').css("display","none");
    		$('.manageclose').css("display","none");
    		$('.manage').css("display","block");
    	}
    	function errorImg(imgs){
	        		imgs.src = "__STATIC__/images/nopic.png"; imgs.onerror = null; 
	     }
    	function delcollect(){
    		var ids = [];
			$("input[name='favid']:checked").each(function(i){
				ids.push($(this).val());
			})
			if(ids.length>0){
				for(var i=0;i<ids.length;i++){
					$.ajax({
						type:"get",
						url:"/index.php/hy/content/delcollect/id/"+ids[i],
						async:true,
						success:function(data){
							console.log(data);
						}
					});
				}
				location.reload();
			}
    	}
    	function boxclick(){
    		var ids = [];
			$("input[name='favid']:checked").each(function(i){
				ids.push($(this).val())
//				$("body").append("<p>"+$(this).val()+"</p>")
			})
			if(ids.length>0){
				$('.delbtn').text("删除("+ids.length+")");
				$('.delbtn').css('color','red');
			}else if(ids.length==0){
				$('.delbtn').text("删除");
				$('.delbtn').css('color','#999999');
			}
    		console.log(ids.length);
    	}
    	function collcheckbox(){
    		var ii=0;
			$("input[name='favid']:checked").each(function(i){
				ii=i;
			})
			if(ii==$("input[name='favid']").length-1){
//				$("input[name='favid']").prop("checked",false);
				var checked = $("input[name='favid']").prop("checked");
		    	$("input[name='favid']").prop("checked",!checked);
			}else{
				$("input[name='favid']").each(function(i){
					$(this).prop("checked",true);
				})
//				$("input[name='favid']").attr("checked",true);
			}
			boxclick();
    	}
    	function getxin(){
    		var xinlength=$('.listbottom .xin').length;
    		for(var i=0;i<xinlength;i++){
    			var xinobj=$('.listbottom .xin').eq(i);
    			console.log($('.listbottom .xin').eq(i).attr("data-data"));
    			var infoid=$('.listbottom .xin').eq(i).attr("data-data");
    			var collecthtml="";
    			console.log(infoid+"infoid")
    			var xincount=getcommgradexin(infoid);
    			for(var j=1;j<=5;j++){
					if(j>xincount){
						collecthtml+='<img src="/public/static/hy/assets/images/huix.png" alt="">';
					}else{
						collecthtml+='<img src="/public/static/hy/assets/images/Stars.png" alt="">';
					}
				}
    			$('.listbottom .star').eq(i+1).append(collecthtml);
    			console.log($('.listbottom .star').eq(i+1));
//  			$('.listbottom .star').eq(i+1).removeClass("xin");
    		}
    	}
    	var pages=1;
    	getcollect();
    	function getcollect(){
    		$.ajax({
    			type:"get",
    			url:"/index.php/hy/content/getcollect/rows/5/pages/"+pages,
    			async:true,
    			success:function(data){
    				console.log(data);
    				if(data!=null&&data!=""&&data!=0){
    					var collecthtml="";
    					for(var i in data){
    						collecthtml+='<div class="ListBox" >';
    						collecthtml+='<div class="colldel">';
    						collecthtml+='<div style="margin: auto;"><input class="favid" type="checkbox" name="favid" onclick="boxclick()" value="'+data[i]['favid']+'" /></div>';
    						collecthtml+='</div>';
    						collecthtml+='<div class="box" style="width: 84%;" data-data="'+data[i]['id']+'" onclick="collectgo(this)"> ';
    						collecthtml+='<div class="listtop"><img src="/public/'+data[i]['picurl']+'" onerror="errorImg(this)"></div>';
    						collecthtml+='<div class="listbottom">';
    						collecthtml+='<div class="title">'+data[i]['title']+'</div> ';
    						collecthtml+='<div class="star_'+data[i]['id']+'" data-data="'+data[i]['id']+'">';    						
    						collecthtml+='</div>';
    						collecthtml+='<div class="text">'+data[i]['content']+'</div>';
    						collecthtml+='</div>';
    						collecthtml+='</div>';
    						collecthtml+='</div>';
    						getcommgradexin(data[i]['id']);    						
    					}
    					pages++;
    					$('.collectlist').append(collecthtml);
    				}else{
    					if(pages>1){
    						layer.msg('没有更多了');
    					}
    				}
    			}
    		});
    	}
    </script>
{include file="index@share"/}
	</body>
</html>